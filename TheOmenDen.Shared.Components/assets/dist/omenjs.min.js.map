{"version":3,"file":"omenjs.min.js","mappings":"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","sources":["webpack:///./dynamicScriptLoader.ts","webpack:///./reCAPTCHAInterop.ts","webpack:///webpack/bootstrap","webpack:///./index.ts"],"sourcesContent":["import { IScriptLoaderOptions } from \"./IScriptLoaderOptions\";\r\n\r\ninterface IScriptLoaderContract {\r\n    /**\r\n     * Loads a script from a given url\r\n     *\r\n     * @param {string} url - The url of the script to load\r\n     * @param {IScriptLoaderOptions} options - Options for the script loader\r\n     * @returns {Promise<void>}\r\n     *\r\n     * @throws {Error}\r\n     * Thrown when the script fails to load after the max retries\r\n     *\r\n     * @public \r\n     */\r\n    loadScript: (url: string, options: IScriptLoaderOptions) => Promise<void>;\r\n}\r\n\r\n/**\r\n A simple utility that can be used to load a script tag into your application.\r\n */\r\nexport class ScriptLoader implements IScriptLoaderContract {\r\n    private _loadedScripts: Set<string> = new Set<string>();\r\n    private _targetElement: HTMLElement;\r\n\r\n    constructor() {\r\n        this._targetElement = document.head; // Default to head\r\n    }\r\n\r\n    /**\r\n     * Loads a script from a given url\r\n     *\r\n     * @param {string} url - The url of the script to load\r\n     * @param {IScriptLoaderOptions} options - Options for the script loader\r\n     * @returns {Promise<void>}\r\n     *\r\n     * @throws {Error}\r\n     * Thrown when the script fails to load after the max retries\r\n     *\r\n     * @public \r\n     */\r\n    async loadScript(url: string, options: IScriptLoaderOptions = {}): Promise<void> {\r\n        const maxRetries = options.maxRetries || 3;\r\n        const retryDelay = options.retryInterval || 25;\r\n\r\n        if (this.isScriptLoaded(url, options.id)) {\r\n            this.logOutResult(\"Script Already Loaded\");\r\n            return;\r\n        }\r\n\r\n        let retries = 0;\r\n\r\n        while (retries <= maxRetries) {\r\n            try {\r\n                await this.loadScriptAttempt(url, options);\r\n                return;\r\n            } catch (error) {\r\n                if (retries >= maxRetries) {\r\n                    this.logOutError(\"Script Failed To Load after retries\");\r\n                    throw error;\r\n                }\r\n\r\n                retries++;\r\n                this.logOutError(`Script Failed To Load. Retrying... (${retries}/${maxRetries})`);\r\n                await new Promise((resolve) => setTimeout(resolve, retryDelay));\r\n            }\r\n        }\r\n    }\r\n\r\n    private async loadScriptAttempt(url: string, options: IScriptLoaderOptions): Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            const script = document.createElement(\"script\") as HTMLScriptElement;\r\n            script.src = url;\r\n            script.onload = () => {\r\n                this._loadedScripts.add(url + (options.id || \"\"));\r\n                this.logOutResult(\"Script Loaded successfully\");\r\n                resolve();\r\n            };\r\n            script.onerror = () => {\r\n                reject(new Error(\"Script failed to load\"));\r\n            };\r\n\r\n            this.setScriptAttributes(script, options);\r\n\r\n            const targetElement = this.getTargetElement(options.appendedTo);\r\n            targetElement.appendChild(script);\r\n        });\r\n    }\r\n\r\n\r\n    private setScriptAttributes(script: HTMLScriptElement, options: IScriptLoaderOptions): void {\r\n        script.type = \"text/javascript\";\r\n        script.defer = options.isDeferred || false;\r\n        script.async = options.isAsync || false;\r\n        script.id = options.id || \"\";\r\n    }\r\n\r\n    private getTargetElement(appendTo?: \"head\" | \"body\"): HTMLElement {\r\n        return appendTo === \"head\" ? this._targetElement : document.body;\r\n    }\r\n\r\n    private isScriptLoaded(url: string, id?: string): boolean {\r\n        const scriptKey = url + (id || \"\");\r\n        return this._loadedScripts.has(scriptKey);\r\n    }\r\n\r\n    private logOutResult(message: string): void {\r\n        console.info(`[ScriptLoader]: ${message}`);\r\n    }\r\n\r\n    private logOutError(error: string): void {\r\n        console.error(`[ScriptLoader]: ${error}`);\r\n    }\r\n}","import { ICaptchaRenderParameters } from './ICaptchaRenderParameters';\r\nimport { IScriptLoaderOptions } from './IScriptLoaderOptions';\r\nimport { ScriptLoader } from './dynamicScriptLoader';\r\nimport { DotNet } from \"@microsoft/dotnet-js-interop\";\r\n\r\ndeclare const grecaptcha: ReCaptchaV2.ReCaptcha;\r\n\r\n/**\r\n * A simple utility that can be used to load a ReCaptcha script tag into your application.\r\n * This class also provides methods to execute and render a captcha.\r\n */\r\nexport class CaptchaLoader {\r\n    private readonly _defaultScriptLoadingOptions: IScriptLoaderOptions = {\r\n        isAsync: true,\r\n        isDeferred: true,\r\n        appendedTo: \"head\",\r\n        maxRetries: 3,\r\n        retryInterval: 100,\r\n        id: \"captchaLoader\"\r\n    };\r\n\r\n    /**\r\n     * Loads the captcha script with the provided site key, and an optional override for the default loading parameters.\r\n     * @param siteKey - The provided site key\r\n     * @param dotNetObjRef - A reference to the dotnet object that will be used to invoke the callback methods\r\n     * @param loadingOptions - Optional parameters to override the default loading parameters\r\n     */\r\n    async loadAsync(siteKey: string, dotNetObjRef: DotNet.DotNetObject, loadingOptions?: IScriptLoaderOptions): Promise<void> {\r\n        try {\r\n            const scriptLoader = new ScriptLoader();\r\n\r\n            const url = `https://www.google.com/recaptcha/api.js?render=${siteKey}`;\r\n\r\n            loadingOptions = { ...this._defaultScriptLoadingOptions, ...loadingOptions };\r\n\r\n            await scriptLoader.loadScript(url, loadingOptions);\r\n        } catch (error) {\r\n            const errorMessage = error instanceof Error ? error.message : \"try again later\";\r\n            console.error(`An error occurred while loading captcha.`);\r\n            await dotNetObjRef.invokeMethodAsync(\"OnCaptchaError\", errorMessage);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Allows the caller to execute a captcha, with an optional action parameter.\r\n     * The default action is \"homepage\"\r\n     * @param dotNetObjRef - A reference to the dotnet object that will be used to invoke the callback methods\r\n     * @param siteKey - The provided site key\r\n     * @param action - Optional action parameter\r\n     */\r\n    async executeAsync(dotNetObjRef: DotNet.DotNetObject, siteKey: string, action?: string): Promise<void> {\r\n        try {\r\n            const response = await grecaptcha.execute(siteKey, { action: action || \"homepage\" });\r\n            await dotNetObjRef.invokeMethodAsync(\"OnCaptchaExecuted\", response);\r\n\r\n        } catch (error) {\r\n            const errorMessage = error instanceof Error ? error.message : \"try again later\";\r\n            console.error(`An error occurred while executing captcha.`);\r\n            await dotNetObjRef.invokeMethodAsync(\"OnCaptchaError\", errorMessage);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Allows the caller to render a captcha in a specific container, with the option to override the default parameters.\r\n     * A default container is used if none is specified - \"recaptcha_container\"\r\n     * @param siteKey - The provided site key\r\n     * @param dotNetObjRef - A reference to the dotnet object that will be used to invoke the callback methods\r\n     * @param renderParameters - Optional parameters to override the default rendering parameters\r\n     */\r\n    async renderAsync(siteKey: string, dotNetObjRef: DotNet.DotNetObject, renderParameters?: ICaptchaRenderParameters): Promise<void> {\r\n\r\n        const transformedParameters: ReCaptchaV2.Parameters = {\r\n            sitekey: siteKey,\r\n            theme: renderParameters?.theme || \"dark\",\r\n            size: renderParameters?.size || \"compact\",\r\n            tabindex: renderParameters?.tabindex || 0,\r\n            badge: renderParameters?.badge || \"bottomright\",\r\n            callback: async (response) => {\r\n                await dotNetObjRef.invokeMethodAsync(\"OnCaptchaResolved\", response);\r\n            },\r\n            \"expired-callback\": async () => {\r\n                await dotNetObjRef.invokeMethodAsync(\"OnCaptchaExpired\");\r\n            },\r\n            \"error-callback\": async () => {\r\n                await dotNetObjRef.invokeMethodAsync(\"OnCaptchaError\");\r\n            }\r\n        };\r\n\r\n        let widgetId = 0;\r\n\r\n        grecaptcha.ready(() => {\r\n            const actualizedContainer = renderParameters?.container || \"recaptcha_container\";\r\n\r\n            widgetId = grecaptcha.render(actualizedContainer, transformedParameters);\r\n        });\r\n\r\n        await dotNetObjRef.invokeMethodAsync(\"OnCaptchaRendered\", widgetId);\r\n    }\r\n\r\n    /**\r\n     * Resets the Captcha Challenge\r\n     * @param dotNetObjRef the dotnet object reference\r\n     * @param widgetId the widget id to reset - OPTIONAL\r\n     */\r\n    async resetAsync(dotNetObjRef: DotNet.DotNetObject, widgetId?: number): Promise<void> {\r\n        grecaptcha.reset(widgetId);\r\n        await dotNetObjRef.invokeMethodAsync(\"OnCaptchaReset\", widgetId);\r\n    }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { ScriptLoader } from \"./dynamicScriptLoader\";\r\nimport { CaptchaLoader } from \"./reCAPTCHAInterop\";\r\n\r\ndeclare global {\r\n    interface Window {\r\n        scriptLoader: ScriptLoader;\r\n        captchaLoader: CaptchaLoader;\r\n    }\r\n}\r\n\r\n(window as any).scriptLoader = new ScriptLoader();\r\n(window as any).reCaptchaInterop = new CaptchaLoader();"],"names":["_loadedScripts","Set","_targetElement","constructor","this","document","head","async","url","options","maxRetries","retryDelay","retryInterval","isScriptLoaded","id","logOutResult","retries","loadScriptAttempt","error","logOutError","Promise","resolve","setTimeout","reject","script","createElement","src","onload","add","onerror","Error","setScriptAttributes","getTargetElement","appendedTo","appendChild","type","defer","isDeferred","isAsync","appendTo","body","scriptKey","has","message","console","info","_defaultScriptLoadingOptions","siteKey","dotNetObjRef","loadingOptions","scriptLoader","ScriptLoader","loadScript","errorMessage","invokeMethodAsync","action","response","grecaptcha","execute","renderParameters","transformedParameters","sitekey","theme","size","tabindex","badge","callback","widgetId","ready","actualizedContainer","container","render","reset","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","window","reCaptchaInterop","CaptchaLoader"],"sourceRoot":""}